// File: a.js
// ======================================================================
require("./input")
require("child_process")
{
  // Tainted execution: dữ liệu từ user được exec trực tiếp
  console.log("Executing command:", command);
  exec(command, (error, stdout, stderr) => {
    if (error) {
      console.error(`Error: ${error.message}`);
      return;
    }
    if (stderr) {
      console.error(`Stderr: ${stderr}`);
      return;
    }
    console.log(`Output:\n${stdout}`);
  });
}
exec(command, (error, stdout, stderr) => {
    if (error) {
      console.error(`Error: ${error.message}`);
      return;
    }
    if (stderr) {
      console.error(`Stderr: ${stderr}`);
      return;
    }
    console.log(`Output:\n${stdout}`);
  })

// File: input.js
// ======================================================================
require("readline")
rl.question("Enter your command: ", (userInput) => {
  // userInput là dữ liệu tainted
  module.exports = { command: userInput };
  rl.close();
})
